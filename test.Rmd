---
title: "R Notebook"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---

```{r}
rm(list = ls())

library(Lahman)
library(mosaic)
library(tidyr)
library(tidyverse)
library(dplyr)
library(mplot)
library(ggplot2)
```

```{r}
#Load in People, Batting, and Pitching Dataframes
data("People") 
data("Batting")
data("Pitching")
```

```{r}
#Merges player name to Batting data. 
bstats <- battingStats()
	str(bstats)
	

People$name <- paste(People$nameFirst, People$nameLast, sep = " ")

batting_name <- merge(Batting,
                 People[,c("playerID", "name")],
                 by = "playerID", all.x = TRUE)

#Merges player name to Pitching data.

People$name <- paste(People$nameFirst, People$nameLast, sep = " ")

pitching_name <- merge(Pitching,
                 People[,c("playerID", "name")],
                 by = "playerID", all.x = TRUE)
```

```{r}
#Creating additional stats for bstats
bstats[is.na(bstats)] = 0

bstats <- bstats %>%
  mutate(K_Percent = SO / PA) %>%
  mutate(BB_Percent = (BB + IBB) / PA)
  
```

## Data Preparation (Lesson 1 & 2)

```{r}
#Keep players with over 150 at bats. (We can change this value if necessary).
#Creating batting average variable.

batting <- bstats %>%
  filter(AB >= 150)
  
```


## Exploratory Analysis (Lesson 1 & 2)
Lessons 1 and 2 will just be parts of the overall project. Simple things like data manipulation, apply functions, boxplots, etc. This will be data preparation items and exploratory analysis.

```{r}
b <- ggplot(batting, aes(x = teamID, y = HR)) +
  geom_boxplot(col = "black", aes(fill = teamID))
b

```

```{r}
hitters1 <- batting %>%
  filter(yearID < 1895) %>%
  select(SlugPct)

hitters2 <- batting %>%
  filter(yearID > 1894, yearID < 1921) %>%
  select(SlugPct)

hitters3 <- batting %>%
  filter(yearID > 1920, yearID < 1969) %>%
  select(SlugPct)

hitters4 <- batting %>%
  filter(yearID > 1969) %>%
  select(SlugPct)
#Organizing 4 different datasets looking at slugging percentage for the following boxplots. All of these are somewhat different eras, with the most dramatic split being from before 1920 (pre-Babe Ruth) and after 1920 (during and post-Babe Ruth)
```

```{r}
boxplot(hitters1,
        main = "Slugging percentage from late 1871 - 1894",
        ylab = "Slugging percentage",
        col = "blue",
        horizontal = TRUE)
```

```{r}
boxplot(hitters2, 
        main = "Slugging percentage from 1895-1920",
        ylab = "Slugging percentage",
        col = "yellow",
        horizontal = TRUE)
```

```{r}
boxplot(hitters3, 
        main = "Slugging percentage from 1921-1968",
        ylab = "Slugging percentage",
        col = "red",
        horizontal = TRUE)
```

```{r}
boxplot(hitters4, 
        main = "Slugging percentage from 1969 - present",
        ylab = "Slugging percentage",
        col = "red",
        horizontal = TRUE)
```


```{r}
sapply(hitters1, mean, na.rm = T)
sapply(hitters2, mean, na.rm = T)
sapply(hitters3, mean, na.rm = T)
sapply(hitters4, mean, na.rm = T)
#Notice that gigantic increase between hitters2 and hitters3
```

```{r}
summary(hitters1)
```

```{r}
summary(hitters2)
```

```{r}
summary(hitters3)
```

```{r}
summary(hitters4)
```

```{r}
#Remove non-numerical values
batting_num <- batting_name %>%
  select_if(batting_name, is.numeric)
  
```

```{r}
batting_num <- batting_num %>%
  select("R", "H", "HR", "RBI", "SO", "BA", "PA", "OPS", "BABIP")
```

```{r}
pairs(batting_num)
```


## 0-dimensional Reduction (Lesson 4)

#### Bootstrapping

## PCA (Lesson 4)

#### Screeplot

#### Biplot

## Cluster Analysis (Lesson 5)

#### Silhouette

#### Diana

## Linear Regression (Lesson 6)

## Simple Linear Regression

## Multiple Linear Regression
